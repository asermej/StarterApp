using System;
using System.Linq;
using Platform.DomainLayer;
using Platform.Api.ResourcesModels;

namespace Platform.Api.Mappers;

/// <summary>
/// Maps between domain models and resource models for {{featureName}}
/// </summary>
public static class {{featureName}}Mapper
{
    /// <summary>
    /// Maps a domain model to a resource model
    /// </summary>
    public static {{featureName}}Resource ToResource({{featureName}} domain)
    {
        if (domain == null)
            return null;

        return new {{featureName}}Resource
        {
            Id = domain.Id,
            {{#each responseProperties}}
            {{#unless (eq name 'Id')}}
            {{name}} = domain.{{name}},
            {{/unless}}
            {{/each}}
            CreatedAt = domain.CreatedAt,
            UpdatedAt = domain.UpdatedAt
        };
    }

    /// <summary>
    /// Maps a create resource model to a create DTO
    /// </summary>
    public static Create{{featureName}}Dto ToDto(Create{{featureName}}Resource resource)
    {
        if (resource == null)
            return null;

        return new Create{{featureName}}Dto
        {
            {{#each inputProperties}}
            {{name}} = resource.{{name}},
            {{/each}}
        };
    }

    /// <summary>
    /// Maps an update resource model to an update DTO
    /// </summary>
    public static Update{{featureName}}Dto ToDto(Update{{featureName}}Resource resource)
    {
        if (resource == null)
            return null;

        return new Update{{featureName}}Dto
        {
            {{#each inputProperties}}
            {{name}} = resource.{{name}},
            {{/each}}
        };
    }

    /// <summary>
    /// Maps a search request to search criteria
    /// </summary>
    public static Search{{featureName}}Criteria ToCriteria(Search{{featureName}}Request request)
    {
        if (request == null)
            return null;

        return new Search{{featureName}}Criteria
        {
            {{#each filterableProperties}}
            {{name}} = request.{{name}},
            {{/each}}
            CreatedAtRange = request.CreatedAtRange,
            UpdatedAtRange = request.UpdatedAtRange,
            PageNumber = request.PageNumber,
            PageSize = request.PageSize,
            SortBy = request.SortBy,
            SortDescending = request.SortDescending
        };
    }

    /// <summary>
    /// Maps a collection of domain models to resource models
    /// </summary>
    public static IEnumerable<{{featureName}}Resource> ToResources(IEnumerable<{{featureName}}> domains)
    {
        return domains?.Select(ToResource) ?? Enumerable.Empty<{{featureName}}Resource>();
    }
}